# Numpyを使ってランダムなデータを生成する

## detail

### 概要

ダミーデータを作成する際、少ない件数であれば手で適当に作成することもできる。

```python
>>> hoge = 123
>>> fuga = 'foo'
>>> piyo = [1, 100, 'bar', 'baz', ['ham', 'eggs', 'spam']]
>>> hoge
123
>>> fuga
'foo'
>>> piyo
[1, 100, 'bar', 'baz', ['ham', 'eggs', 'spam']]
```

これくらいなら、手動で作成するのもありだと思う。

ところが、「100件近くダミーデータが欲しい」とか「任意の順番で欠損値や空文字があるような配列が欲しい」とかだと、手動で行うには途端に難しくなる。場合によっては「正規分布に従うようなデータが欲しい」と言った場合も同様だ。よって何かしらの方法で、自動的に作成したい。そういうときはNumpyが使える。

### 件数の多いダミーデータが欲しい

```python
>>> hoge = [1] * 100
>>> hoge
[1, 1, 1, （中略）, 1, 1, 1]
>>> len(hoge)
100
>>> hoge = list(range(100))
>>> hoge
[0, 1, 2, 3,（中略）, 97, 98, 99]
>>> len(hoge)
100
```

上記のような方法もあるので、単純に件数が多いだけのデータが欲しいだけならわざわざNumpyを利用する理由はないかもしれない。ところが**ランダムなデータ**が多く欲しいとなると、Numpyの出番になる。

```python
>>> import numpy as np
>>> rnd = np.random.rand()
>>> rnd
0.2267920845721343
>>> rnd = np.random.rand(10)
>>> rnd
array([0.34897338, 0.50646042, 0.82445755, 0.13532703, 0.5615308 ,
       0.99097183, 0.34604998, 0.0824444 , 0.36993365, 0.57215088])
>>> rnd = np.random.rand(3, 4)
>>> rnd
array([[0.99428626, 0.25346584, 0.11747942, 0.21326272],
       [0.68696035, 0.80780506, 0.57490197, 0.49700296],
       [0.32404102, 0.85367465, 0.20015029, 0.2259746 ]])
>>> rnd = np.random.rand(3, 2, 2)
>>> rnd
array([[[0.08126794, 0.68250418],
        [0.47870644, 0.06530604]],

       [[0.73926644, 0.47172836],
        [0.82021227, 0.74844969]],

       [[0.58009998, 0.06726452],
        [0.98567293, 0.56935939]]])
```

`numpy.random.rand()`を利用すると、0以上1未満の範囲でランダムな数値を出力する。このとき、引数は配列の要素数を指定できる。カンマで区切ると各次元の要素数を指定でき、ランダムな数値を持つ多次元配列のダミーデータを生成可能。

```python
>>> (10 - 1) * np.random.rand() + 1
3.6732961129703794
>>> (10 - 1) * np.random.rand(10) + 1
array([6.92422432, 6.96783714, 6.61130273, 8.46465412, 7.19589737,
       1.40296861, 3.79200747, 7.05247393, 1.35635717, 1.44476285])
```

なお、0以上1未満では足りない場合は` (b - a) * np.random.rand() + a`という式にすると、「a以上b未満」でランダムな**小数**を生成できる。強調するがあくまでも生成するのは小数なので注意。

```python
>>> np.random.randint(10)
9
>>> np.random.randint(10)
1
>>> np.random.randint(1, 10, (4))
array([3, 8, 9, 3])
>>> np.random.randint(1, 10, (2, 3))
array([[5, 3, 8],
       [5, 6, 6]])
>>> np.random.randint(1, 10, (4, 3, 2))
array([[[1, 8],
        [3, 7],
        [7, 5]],

       [[2, 4],
        [7, 9],
        [4, 1]],

       [[2, 5],
        [6, 7],
        [4, 8]],

       [[4, 4],
        [3, 5],
        [9, 2]]])
>>> np.random.randint(1, 10, (4, 5))
array([[2, 1, 1, 8, 5],
       [3, 3, 8, 1, 2],
       [6, 2, 6, 2, 8],
       [4, 6, 7, 3, 6]])
```

`numpy.random.randint()`を利用すると、a以上b未満の整数でランダムな数値を生成する。引数が1つだけの場合は0以上a未満のようだ。また、タプルで次元数を指定することで多次元配列での生成も可能。

### 欠損値などを含んだデータが欲しい

配列などに欠損値含めたい場合は`numpy.nan`を用いる。

```python
>>> hoge = [1, 2, 3, np.nan]
>>> hoge
[1, 2, 3, nan]
```

上記のように`numpy.nan`を含めると、欠損値を指定したことになりデータ（今回は配列）に欠損値が含まれることになる。

ただ、上記は要素数が少なかったため手でダミーデータを作成したが、要素数が多くなるとこの手は使えない。

```python
>>> [1, 2, 3] + [np.nan] * 10
[1, 2, 3, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan]
```

一応この方法でも欠損値を含むデータは作成できるし、`[1,2,3]`の部分を`numpy.random.rand()`などで別途生成しておけば、要素数が多くても対応できる。問題は、単純に結合するだけだと配列のどこかの部分に欠損値である`numpy.nan`が固まってしまうため、イマイチ扱いにくいデータになってしまうこと。そのような形式のデータであることがニーズとして存在するなら問題ないが、大抵は「任意の順番で欠損値を含むデータ」のほうがダミーデータだったとしても利用価値があるだろう。つまり、要素の入替をすればこの問題は解決できる。

```python
>>> np.random.permutation(10)
array([0, 8, 9, 3, 1, 2, 7, 6, 5, 4])
>>> hoge = list(np.random.randint(0, 10, (10))) + [np.nan] * 3
>>> hoge
[5, 6, 5, 6, 0, 4, 3, 4, 7, 6, nan, nan, nan]
>>> np.random.permutation(hoge)
array([ 0.,  5.,  5., nan, nan,  4.,  6.,  3.,  4.,  6., nan,  6.,  7.])
```

`numpy.random.permutation()`を利用すると、引数に整数を指定した場合は`numpy.arange()`を実行してから、その結果をランダムに並べ替える。引数にリストを指定した場合は、リスト内の要素をランダムに並べ替える。

ちなみに、上記のコードで`np.random.randint(0, 10, (10))`で生成した結果を`list()`を使ってリスト化しているのは、`+`を使える対象がリストだけである（Numpyのndarrayはできない）ため。

### ある分布に従うようなデータが欲しい

正規分布やポワソン分布など、一定の分布に従うようなデータが欲しい場合は、Numpyのそれ用の関数を利用することで実装可能。

```python
>>> hoge = np.random.randn(10)
>>> hoge
array([ 0.82527296,  0.69508686,  0.32685416,  1.54860155,  1.01731356,
       -0.09683983, -0.09586703, -1.44566791, -2.37201106,  0.2798125 ])
>>> hoge = np.random.randn(10, 3, 2)
>>> hoge
array([[[ 1.05621753, -1.24221983],
        [-0.1998709 , -0.51039188],
        [ 1.11626393,  1.00106683]],

       [[ 0.25515752, -1.39948184],
        [-0.01883365, -2.8283231 ],
        [ 0.87249319,  0.20883916]],

       [[-0.02252693,  0.90705709],
        [ 1.43126333,  0.45707534],
        [-0.2900846 ,  0.0763693 ]],

       [[-0.6147408 ,  0.09547094],
        [ 0.74952956, -0.45439817],
        [ 2.37966018, -1.25369639]],

       [[-0.91282178,  0.44044054],
        [-0.56374417,  0.3669225 ],
        [-0.18080356, -0.68312957]],

       [[-0.72384732, -0.26918093],
        [-2.39920577, -1.29720853],
        [-0.61976411, -0.30331131]],

       [[ 0.83409612, -0.6459357 ],
        [ 1.41603931, -0.93375942],
        [-1.03674943,  0.22429298]],

       [[-0.81397886, -1.39625906],
        [-0.55257818,  0.85184755],
        [ 0.12548214,  0.72741639]],

       [[ 2.19164464, -0.13111531],
        [ 0.04555343,  1.51691346],
        [-0.19544709, -0.66328109]],

       [[ 0.40160743,  0.20878436],
        [ 0.5087372 ,  0.44865965],
        [-0.34112219, -0.10326487]]])
>>> hoge.shape
(10, 3, 2)
>>> hoge = np.random.normal(50, 10, (4, 2))
>>> hoge
array([[61.66259634, 52.69596165],
       [49.35872635, 47.29646802],
       [52.69218421, 47.90504674],
       [39.80646604, 57.39483636]])
>>> hoge.shape
(4, 2)
>>> hoge = np.random.normal(size=(3, 4, 2))
>>> hoge
array([[[-0.95014927,  1.00784802],
        [ 0.8021262 ,  0.89439479],
        [-1.49008143, -2.49125177],
        [ 1.98253422, -2.04261543]],

       [[ 0.36045609,  0.04028661],
        [-0.05706396, -2.14257983],
        [ 1.04109987,  0.50266427],
        [ 0.67699266,  1.17091088]],

       [[-0.84241085,  0.80383722],
        [-0.00546472, -0.89657629],
        [-0.11819461, -1.33541699],
        [ 1.14810868,  0.0089522 ]]])
>>> hoge.shape
(3, 4, 2)
```

正規分布に従いデータが欲しい場合は2パターンあり得る。1つは標準正規分布に従うデータのケースだが、この場合は`numpy.random.randn()`を使う。もう1つは任意の標準偏差と平均による正規分布に従うデータのケースで、この場合は`numpy.random.normal()`を利用する。平均値を50、標準偏差を10とすれば、偏差値のデータを生成できることになる。

他の分布に関しては[ここ](https://numpy.org/devdocs/reference/random/generator.html#distributions)を参照。

## reference

1. [Random Generator](https://numpy.org/devdocs/reference/random/generator.html#distributions)
2. [NumPy, randomで様々な種類の乱数の配列を生成](https://note.nkmk.me/python-numpy-random/)
3. [numpy.random.permutation – 配列の要素をランダムに並べ替えた新しい配列を生成](https://www.headboost.jp/numpy-random-permutation/)
